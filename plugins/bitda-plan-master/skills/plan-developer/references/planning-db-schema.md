# 기획문서 DB 스키마

> 이 파일은 Notion 기획문서 DB의 구조와 각 컬럼의 입력 규칙을 정의합니다.
> Claude가 기획 내용을 자동으로 DB에 입력할 때 이 문서를 참조합니다.

---

## DB 연동 정보

> **하드코딩 상수**: 아래 ID/URL은 안정적이므로 매번 `notion-fetch`할 필요 없음.
> Data Source URL은 `notion-search`의 `data_source_url` 파라미터에 사용.

### 01.기획문서 DB
- **DB URL**: https://www.notion.so/2df471f8dcff80b29a6df9972b15aa06
- **DB ID**: `2df471f8-dcff-80b2-9a6d-f9972b15aa06`
- **Data Source URL**: `collection://2df471f8-dcff-8083-8ce6-000b81ceb6f9`
- **Parent Page**: 01. 기획문서

### 02.화면코드 DB
- **DB ID**: `2d3471f8-dcff-802f-945f-c5add962fc6f`
- **Data Source URL**: `collection://2d3471f8-dcff-8067-b573-000b0e2b1d04`

### 03.컴포넌트 & 로직 DB
- **DB ID**: `2d3471f8-dcff-80d2-8041-f0e98910c922`
- **Data Source URL**: `collection://2d3471f8-dcff-8076-a4a3-000b502a3811`

### 마스터 기능코드
- **DB ID**: `2d3471f8-dcff-80cd-9de7-dac5de60856a`
- **Data Source URL**: `collection://2d3471f8-dcff-803d-8b2c-000b5b9855af`
- **스키마**: 기능 코드(Title), 원어(Text), 한글(Text), 도메인(Relation), 모듈 코드(Relation), 화면 DB(Relation)

### 도메인 코드
- **Data Source URL**: `collection://2d3471f8-dcff-8088-a81c-000b8b1e88b0`

### 모듈 코드
- **Data Source URL**: `collection://2d3471f8-dcff-80e9-b5b6-000be9b1876d`

### 화면유형 코드
- **Data Source URL**: `collection://2d3471f8-dcff-8051-ac76-000b25732bf2`

---

## 1. 기본 정보 (Basic Info)

| 컬럼명 | 타입 | 필수 | 설명 | 입력 규칙 |
|--------|------|------|------|-----------|
| 기획 명칭 | Title | ✓ | 기획서 제목 | `[유형약어] 기능명` 형식. 예: `[FEAT] 작업지시 관리` |
| 기획 요약 | Text | ✓ | 기획 핵심 요약 | 2-3문장으로 목적과 주요 기능 요약 |
| 유형 | Select | ✓ | 기획 유형 | 아래 옵션 중 선택 |
| 우선 순위 | Select | ✓ | 작업 우선순위 | 아래 옵션 중 선택 |
| 담당 기획자 | Created By | 자동 | 문서 생성자 | 시스템 자동 입력 |

### 유형 옵션

| 값 | 설명 | 명칭 약어 |
|-----|------|----------|
| 신규 기능 | 완전히 새로운 기능 추가 | [FEAT] |
| 기능 개선 | 기존 기능의 확장/개선 | [ENH] |
| 버그 수정 | 오류/결함 해결 | [FIX] |
| 기술 부채 | 코드 품질/구조 개선 | [TECH] |

### 우선 순위 옵션

| 값 | 설명 | 대응 시간 |
|-----|------|----------|
| P0(긴급) | 서비스 장애, 보안 이슈 | 즉시 |
| P1(높음) | 핵심 기능, 마감 임박 | 1주 이내 |
| P2(보통) | 일반 기능 개발 | 스프린트 내 |
| P3(낮음) | 개선 사항, 기술 부채 | 여유 시 |

---

## 2. 진행 상태 (Workflow)

| 컬럼명 | 타입 | 필수 | 설명 | 입력 규칙 |
|--------|------|------|------|-----------|
| 진행 단계 | Status | ✓ | 현재 진행 상태 | 아래 워크플로우 참조 |
| 버전 | Number | ✓ | 문서 버전 | `1.0`부터 시작 |
| 최종 업데이트 | Last Edited Time | 자동 | 마지막 수정 시간 | 시스템 자동 입력 |

### 진행 단계 워크플로우

```
기획 초벌 → 부서 협의중 → 기획 확정 ⇄ 기획 변경
   (to_do)    (in_progress)   (complete)   (complete)
```

> **⚠️ 주의**: Notion REST API에서 정확한 상태명을 사용해야 합니다. 공백 포함 필수.

| 단계 | Notion 정확한 값 | 상태 그룹 | 설명 | 다음 단계 조건 |
|------|-----------------|----------|------|----------------|
| 기획 초벌 | `기획 초벌` | to_do | 초기 기획 작성 중 | 핵심 기능 명세 완료 |
| 부서 협의중 | `부서 협의중` | in_progress | 부서별 검토 진행 | 모든 부서 승인 완료 |
| 기획 확정 | `기획 확정` | complete | 최종 확정 | 디자인 착수 |
| 기획 변경 | `기획 변경` | complete | 확정 후 변경 발생 | 변경 명세서 작성 완료 → 기획 확정으로 복귀 |

### 기획 변경 상태 설명

**기획 변경**은 기획 확정 이후 수정/보완/보충/제거가 발생했을 때 사용합니다.

- **전환 조건**: 기획 확정 상태에서 변경 요청 발생 시
- **복귀 조건**: 변경 명세서 작성 및 부서 확인 완료 시 기획 확정으로 복귀
- **버전 관리**: 2.0 (기획 확정) → 2.1, 2.2, ... (기획 변경)

**변경 유형**:
| 유형 | 설명 | 예시 |
|------|------|------|
| 수정 | 기존 스펙 변경 | 필드 타입 변경, 로직 수정 |
| 보완 | 누락 사항 보충 | 에러 처리 추가, 엣지 케이스 정의 |
| 보충 | 추가 기능/필드 | 신규 필드 추가, 화면 추가 |
| 제거 | 불필요 항목 삭제 | 기능 제거, 필드 삭제 |

---

## 3. 부서별 검토 현황 (Stakeholder Review)

| 컬럼명 | 타입 | 필수 | 설명 | 옵션 |
|--------|------|------|------|------|
| 사업팀 검토 | Select | - | 사업팀 검토 상태 | 대기 / 의견있음 / 승인 완료 |
| BE 검토 | Select | - | 백엔드팀 검토 상태 | 대기 / 기술검토필요 / 승인 완료 |
| FE 검토 | Select | - | 프론트엔드팀 검토 상태 | 대기 / UI구현검토필요 / 승인 완료 |
| 통합 코멘트 | Text | - | 부서별 의견 통합 | 각 부서 의견을 정리하여 기록 |
| 디자인 핸드오프 | Checkbox | - | 디자인 단계 진입 가능 | 모든 검토 완료 시 체크 |

### 검토 상태 흐름

```
대기 → [검토 필요 상태] → 승인 완료
```

- **사업팀**: 대기 → 의견있음 → 승인 완료
- **BE팀**: 대기 → 기술검토필요 → 승인 완료
- **FE팀**: 대기 → UI구현검토필요 → 승인 완료

---

## 4. 개발 영향 범위 (Development Impact)

| 컬럼명 | 타입 | 필수 | 설명 | 입력 규칙 |
|--------|------|------|------|-----------|
| 영향 범위 | Multi-select | - | 수정 필요한 모듈 | 해당 모듈 선택 |
| 인프라 변경 필요 | Checkbox | - | 인프라 변경 여부 | DB 스키마, 신규 서버 등 필요 시 체크 |
| 기술적 의존성 | Text | - | 선행 기술 과제 | 선행 API, 라이브러리 업데이트 등 기록 |

### 영향 범위 입력 가이드

분석된 기능이 영향을 미치는 모듈을 선택합니다:
- 기준정보 관련 → MST 모듈
- 생산관리 관련 → PRD 모듈
- 재고관리 관련 → INV 모듈
- 원가관리 관련 → CST 모듈
- 주세신고 관련 → TAX 모듈
- 시스템 관련 → SYS 모듈

---

## 5. QA 관련 (QA Review)

| 컬럼명 | 타입 | 필수 | 설명 | 입력 규칙 |
|--------|------|------|------|-----------|
| 인수 조건(AC) | Text | - | 최소 성공 기준 | Given-When-Then 형식 권장 |

### 인수 조건 작성 예시

```
Given: 사용자가 작업지시 목록 화면에 있을 때
When: [신규등록] 버튼을 클릭하면
Then: 작업지시 등록 Sheet가 화면 우측에서 슬라이드되어 나타난다

Given: 필수 항목이 모두 입력된 상태에서
When: [저장] 버튼을 클릭하면
Then: 작업지시가 저장되고 목록에 새 항목이 추가된다
```

---

## 6. 이슈 관리 (Issue Management)

| 컬럼명 | 타입 | 필수 | 설명 | 옵션/입력 규칙 |
|--------|------|------|------|---------------|
| 차단 요소 | Select | - | 진행 방해 요인 | 정책 미확정 / 기술적 불가 / 타 부서 협의 / 리소스 부족 |
| 차단 이유 상세 | Text | - | 차단 요소 상세 내용 | 구체적인 내용 기록 |
| 히스토리 | Text | - | 기획 이력 기록 | 중요 변경 사항, 결정 사항 기록 |

---

## 7. 상세 기획서 (Page Content)

> **중요**: 기획서 링크 컬럼은 더 이상 사용하지 않습니다.
> 상세 기획서는 기획문서 DB 항목의 **content 영역**에 직접 작성합니다.

### 작성 방식

1. `notion-create-pages`로 DB 항목 생성 (properties만 설정)
2. `notion-update-page`의 `replace_content` 명령으로 상세 기획서 작성

### 주의사항

- ❌ 별도 페이지 생성 금지
- ❌ 기획서 링크 필드 사용 금지 (삭제됨)
- ✅ DB 항목 content에 직접 Markdown 작성

---

## Claude 자동 입력 규칙

### 신규 기획 등록 시 기본값

```javascript
{
  "기획 명칭": "[유형약어] {기능명}",
  "기획 요약": "{2-3문장 요약}",
  "유형": "신규 기능",  // 또는 분석 결과에 따라
  "우선 순위": "P2(보통)",  // 기본값
  "진행 단계": "기획 초벌",
  "버전": 1.0,
  "사업팀 검토": "대기",
  "BE 검토": "대기",
  "FE 검토": "대기",
  "디자인 핸드오프": "__NO__",
  "인프라 변경 필요": "__NO__"
}
```

### 기획 디벨롭 완료 시 업데이트

```javascript
{
  "진행 단계": "부서 협의중",
  "버전": 1.1,  // +0.1 증가
  "인수 조건(AC)": "{작성된 AC}",
  "영향 범위": "{분석된 모듈 목록}"
}
```

### 모든 부서 승인 완료 시 업데이트

```javascript
{
  "진행 단계": "기획 확정",
  "버전": 2.0,  // 정수로 증가
  "디자인 핸드오프": "__YES__"
}
```

### 기획 변경 발생 시 업데이트

```javascript
{
  "진행 단계": "기획 변경",
  "버전": 2.1,  // 소수점 증가 (2.0 → 2.1 → 2.2)
}
// content에 변경 명세서 추가 (기존 기획서 하단에 append)
```

### 기획 변경 완료 후 복귀

```javascript
{
  "진행 단계": "기획 확정",
  // 버전은 유지 (2.1, 2.2 등)
  "히스토리": "{기존 히스토리}\n[YYYY-MM-DD] v2.1 기획 변경 완료: {변경 요약}"
}
```

---

## Notion API 사용 시 주의사항

### Checkbox 값 형식
- 체크: `"__YES__"`
- 미체크: `"__NO__"` 또는 `null`

### Status 값
- 정확한 옵션명 사용: `"기획 초벌"`, `"부서 협의중"`, `"기획 확정"`

### Multi-select 값
- JSON 배열 형식: `["모듈1", "모듈2"]`

---

## 화면 설계 연동

기획 완료 후 화면 DB와 연동할 때 참조할 정보:

- 화면 DB / 컴포넌트 DB의 ID와 Data Source URL → 상단 "DB 연동 정보" 참조
- 화면 코드 컨벤션: `references/convention-template.md` 참조

---

## 최종 업데이트

- 날짜: 2025-01-06
- 동기화 원본: Notion 기획문서 DB
