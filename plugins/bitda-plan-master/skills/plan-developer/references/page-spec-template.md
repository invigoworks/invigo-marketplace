# 페이지별 기획서 템플릿

> **목적**: 하나의 페이지(하위 메뉴)에 대한 완전한 명세. 프론트엔드/백엔드 개발자가 이 문서만으로 구현 가능해야 함.

---

# [화면코드]-[화면유형]-(화면명) 기획서

> **화면 코드 형식**: `BITDA-[앱]-[모듈]-[기능]-[유형][번호]`
> **화면 유형**: `PAGE` | `OVERLAY` | `TAB`
> 작성일: YYYY-MM-DD
> 버전: 1.0

> **Notion DB 속성**: Prepub URL은 문서 본문이 아닌 `퍼블리싱 결과 확인` 속성에 저장

---

# ━━━━━ PART 1: 화면 DB (→ 02.화면 DB) ━━━━━

## 1. 화면 유형 정의

| 유형 | 설명 | 예시 |
|------|------|------|
| **PAGE** | 독립적인 라우트 페이지 | 목록 페이지, 대시보드 |
| **OVERLAY** | Sheet, Dialog, Drawer 등 | 등록 폼, 상세 보기 |
| **TAB** | 탭 내 콘텐츠 영역 | 상세 페이지의 탭 |

**상위 화면 관계**: OVERLAY, TAB은 부모 PAGE를 명시해야 함

---

## 2. 페이지 개요

### 2.1 배경 (Background)
<!-- 이 페이지가 필요한 이유, 해결하려는 문제 -->

### 2.2 목적 (Purpose)
<!-- 이 페이지의 핵심 목적 -->

### 2.3 사용자 (Target Users)

> **주의**: 역할 코드가 동일하면 하나의 행으로 통합.

| 역할 코드 | 주요 시나리오 |
|----------|--------------|
| ADMIN | 전체 데이터 관리 |

---

## 3. 화면 흐름 (User Flow)

### 3.1 진입 경로
```
사이드바 > [상위 메뉴] > [하위 메뉴]
Route: /[앱]/[모듈]/[기능]
```

### 3.2 화면 내 흐름
```
[메인 화면] (PAGE)
    │
    ├─▶ [등록] 버튼 클릭 → Sheet (OVERLAY)
    │       └─▶ [저장] → 목록 갱신
    │
    ├─▶ [행 클릭] → Sheet (OVERLAY)
    │       ├─▶ [수정] → 목록 갱신
    │       └─▶ [삭제] → 확인 Dialog → 목록 갱신
    │
    └─▶ [검색/필터] → 목록 필터링
```

### 3.3 연결 화면
| 연결 방향 | 화면 코드 | 화면명 | 화면유형 | 연결 방식 |
|----------|----------|--------|---------|----------|
| FROM | - | - | - | 사이드바 메뉴 |
| TO | XXXX-O001 | 등록/수정 폼 | OVERLAY | 버튼/행 클릭 |
| RELATED | YYYY-P001 | 관련 페이지 | PAGE | 버튼 클릭 |

---

## 4. 권한 및 접근 제어

### 4.1 역할 기반 접근 (RBAC)

**ADMIN 전용 페이지인 경우:**
```
역할(Role): ADMIN
권한 코드: 불필요 (역할 기반 접근)
```

**일반 페이지인 경우:**
| 역할 | 조회 | 등록 | 수정 | 삭제 | 비고 |
|------|------|------|------|------|------|
| ADMIN | ✓ | ✓ | ✓ | ✓ | 전체 권한 |
| MANAGER | ✓ | ✓ | ✓ | ✗ | 삭제 불가 |

**권한 코드** (일반 페이지만 해당):
| 기능 | 권한 코드 | 설명 |
|------|----------|------|
| 목록 조회 | `{resource}:read` | 목록 조회 |
| 등록 | `{resource}:create` | 등록 |
| 수정 | `{resource}:update` | 수정 |
| 삭제 | `{resource}:delete` | 삭제 |

### 4.2 모듈/기능 코드
| 구분 | 코드 | 설명 |
|------|------|------|
| 모듈 (Module) | `XX` | 모듈명 |
| 기능 (Feature) | `XX-YYY` | 기능명 |

---

## 5. 레이아웃

```
┌─────────────────────────────────────────────┐
│ PageHeader: [페이지 제목]                    │
├─────────────────────────────────────────────┤
│ Toolbar: [검색] [필터] [등록 버튼]           │
├─────────────────────────────────────────────┤
│                                             │
│              DataTable                      │
│                                             │
├─────────────────────────────────────────────┤
│ Pagination                                  │
└─────────────────────────────────────────────┘
```

---

## 6. DB 연결 정보

| 항목 | 값 | Notion DB 속성 |
|------|------|---------------|
| 화면 코드 | `BITDA-XX-XXX-XXX-S001` | 기획 명칭 |
| Prepub URL | `https://prepub.invigoworks.co.kr/[경로]` | **퍼블리싱 결과 확인** |
| 기획문서 | 현재 문서 URL | url |

> **중요**: Prepub URL은 문서 본문에 기재하지 않고, Notion DB의 `퍼블리싱 결과 확인` 속성(URL 타입)에 저장

---

# ━━━━━ PART 2: 컴포넌트 & 로직 DB (→ 03.컴포넌트 & 로직 DB) ━━━━━

## 1. 인수 조건 (Acceptance Criteria)

> **Given-When-Then 형식**. API 엔드포인트는 Swagger 참조.

### AC-1: [시나리오명]
```gherkin
Given: [전제 조건]
  - 역할: ADMIN

When: [사용자 액션]
  - UI: [버튼명] 클릭 또는 [필드] 입력

Then: [예상 결과]
  - UI: [결과 상태] 표시
  - 후처리: [목록 갱신 등]
```

### AC-2: [시나리오명]
```gherkin
Given: [전제 조건]
When: [사용자 액션]
Then: [예상 결과]
```

---

## 2. 컴포넌트 명세

> **참고**: 검색/필터 기본값, Request/Response Body, QueryParameter, ErrorCode 등은 **Swagger 문서** 참조

| 영역 | shadcn 컴포넌트 | Prepub 매핑 | 설명 |
|------|----------------|-------------|------|
| 검색 | `Input` | TextField | 검색어 입력 |
| 검색 버튼 | `Button` | Button | 검색 실행 |
| 필터 | `Select` | Select | 상태 필터 드롭다운 |
| 목록 | `DataTable` | DataTable | 메인 데이터 테이블 |
| 등록/수정 | `Sheet` + `Form` | Sheet + Form | 슬라이드 패널 폼 |
| 삭제 확인 | `AlertDialog` | AlertDialog | 삭제 전 확인 모달 |
| 알림 | `Toast` (sonner) | Toast | 성공/실패 피드백 |

> **커스텀 컴포넌트/외부 라이브러리 사용 시 별도 명시 필요**

---

## 3. 테이블 컬럼 정의

> **한글 컬럼명만 기재** (기술 필드명은 API 문서 참조)

| 컬럼명 | 타입 | 정렬 | 필터 | 너비 |
|--------|------|------|------|------|
| 번호 | number | ✗ | ✗ | 60px |
| 이름 | string | ✓ | ✓ | auto |
| 상태 | badge | ✗ | ✓ | 100px |
| 등록일 | date | ✓ | ✗ | 120px |

---

## 4. 데이터 명세

### 4.1 입력 필드
> **한글 필드명만 기재** (기술 필드명은 API 문서 참조)

| 필드명 | 필수 | 유효성 검증 | UI 컴포넌트 |
|--------|------|------------|------------|
| 이름 | ✓ | 1~100자 | Input |
| 코드 | ✓ | 영문+숫자, 3~20자 | Input |
| 상태 | ✓ | enum | Select |
| 비고 | ✗ | 최대 500자 | Textarea |

### 4.2 유효성 검증 규칙
| 필드 | 규칙 | 에러 메시지 |
|------|------|------------|
| 이름 | 필수 | "이름을 입력해주세요" |
| 이름 | 최대 100자 | "100자 이내로 입력해주세요" |
| 코드 | 영문+숫자 | "영문 대문자와 숫자만 입력 가능합니다" |
| 코드 | 중복 확인 | "이미 사용 중인 코드입니다" |

---

## 5. 상태별 UI

| 상태 | 조건 | UI 표현 |
|------|------|---------|
| Initial | 페이지 진입 직후 | Skeleton 테이블 |
| Loading | API 호출 중 | Spinner 오버레이 |
| Success | 데이터 있음 | 테이블 + 데이터 |
| Empty | 데이터 0건 | EmptyState + 등록 버튼 |
| Error | 조회 실패 | ErrorState + 재시도 버튼 |

---

## 6. 에러 처리

| HTTP 코드 | 상황 | UI 처리 |
|----------|------|---------|
| **403** | 권한 없음 | **403 페이지 표시** (로그인 이동 X) |
| 404 | 데이터 없음 | Toast + 목록 갱신 |
| 409 | 중복/충돌 | 필드 에러 표시 또는 Toast |
| 500 | 서버 오류 | Toast + 재시도 안내 |

> **중요**: 403 에러 시 로그인 페이지로 이동하지 않고, 403 권한 없음 페이지를 표시해야 함

---

## 7. 비즈니스 규칙

### 7.1 목록 조회 규칙
| 항목 | 규칙 |
|------|------|
| 기본 정렬 | 등록일 기준 최신순 |
| 페이지당 건수 | 20건 (변경 가능: 10/20/50/100) |
| 검색 대상 | 이름, 코드 |
| 검색 방식 | 부분 일치 |

### 7.2 등록/수정 규칙
| 항목 | 규칙 |
|------|------|
| 코드 | 등록 후 수정 불가 |
| 상태 변경 | 활성 ↔ 비활성만 가능 |

### 7.3 삭제 규칙

| 항목 | 규칙 |
|------|------|
| 삭제 조건 | 연결된 데이터가 없어야 함 |
| 삭제 방식 | **Soft Delete** (status = 'DELETED') |

**다건 삭제 처리:**
| 항목 | 규칙 |
|------|------|
| 트랜잭션 | **원자적 처리** (All or Nothing) |
| 실패 시 | 전체 롤백 + 실패 사유 Toast |
| 일부 불가 시 | 삭제 불가 항목 목록 표시 후 사용자 확인 |

> **Soft Delete**: 실제 데이터를 삭제하지 않고 status를 DELETED로 변경

---

# ━━━━━ PART 3: API 맵핑 DB (→ 04.API 맵핑 DB) ━━━━━

## 1. API 의존성 (Dependencies)

### 1.1 사용 API 목록

> **엔드포인트는 Swagger 참조**, 용도와 호출 시점만 명시

| 용도 | 호출 시점 |
|------|----------|
| 목록 조회 | 페이지 로드, 검색, 필터 변경 |
| 상세 조회 | 수정 폼 오픈 |
| 등록 | 저장 버튼 클릭 |
| 수정 | 저장 버튼 클릭 |
| 삭제 | 삭제 확인 |
| 일괄 삭제 | 일괄 삭제 확인 |

### 1.2 데이터 로드 시퀀스
```
페이지 마운트
    │
    └─▶ 목록 조회 API
        ├── 정렬: 최신 등록순
        └── 페이징: 20건씩
```

---

# ━━━━━ 부록 ━━━━━

## 1. 변경 이력

| 버전 | 날짜 | 변경자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | YYYY-MM-DD | | 최초 작성 |
